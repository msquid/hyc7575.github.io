$.fn.rangeSlider=function(e){return this.each(function(){function n(){M.width(v.width).attr({"data-min":v.min,"data-max":v.max}),h=parseInt(M.width(),10)-parseInt(v.handleWidth),w=v.step*(h/b),M.append('<div class="range-slider-select-area"></div><span class="range-slider-handle minimum"></span><span class="range-slider-handle maximum"></span>'),c=M.find(".range-slider-handle.minimum"),o=M.find(".range-slider-handle.maximum"),l=M.find(".range-slider-select-area"),d=M.find(".range-slider-handle"),d.width(v.handleWidth),M.wrap('<div class="range-slider-wrap" style="padding: 30px 0 50px;"></div>'),M.css({position:"relative",width:v.width,height:v.height,filter:"progid:DXImageTransform.Microsoft.gradient(startColorStr=#66ff2402,endColorStr=#66ff2402)","-ms-filter":"progid:DXImageTransform.Microsoft.gradient(startColorStr=#66ff2402,endColorStr=#66ff2402)","background-color":"rgba(255, 115, 89, 0.4)"}),M.find(".range-slider-select-area").css({position:"absolute",width:"100%",height:"inherit",backgroundColor:"rgb(255, 115, 89)","z-ndex":1}),d.css({position:"absolute",top:-(parseInt(v.handleWidth,10)/2),width:v.handleWidth,height:v.handleWidth,borderRadius:"50%",backgroundColor:v.handleColor,border:"2px solid rgb(255, 115, 89)",cursor:"pointer",boxSizing:"border-box","z-index":2}),d.each(function(){var e=$(this);e.hasClass("minimum")?e.css("left",0):e.css({left:h})}),t()}function t(){d.on("mousedown",function(e){var e=window.event||e;I={minHandle:{mouseX:e.clientX,currentX:parseInt(M.find(".minimum").css("left"),10)},maxHandle:{mouseX:e.clientX,currentX:parseInt(M.find(".maximum").css("left"),10)}},X="minimum"===$.fn.rangeSlider.chkHandle(this),p=X?I.minHandle:I.maxHandle,x=X?I.maxHandle:I.minHandle,g=X?M.find(".minimum"):M.find(".maximum")}),$(document).on("mouseup",function(){if(I){var e=p.currentX%w;p.currentX=w/2>e?p.currentX-e:p.currentX+(w-e),(X&&p.currentX>x.currentX||!X&&p.currentX<x.currentX)&&(p.currentX=x.currentX),g.css("left",X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX)),X?V=p.currentX/h*b:H=p.currentX/h*b,u(V,H),i(),a(x.currentX),"function"==typeof v.onBlur&&v.onBlur(),I=null}}),$(document).on("mousemove",function(e){if($(".touch-area").text(),I){var n,t,r,e=window.event||e;e.clientX-M.offset().left<0||e.clientX-M.offset().left>h||(p.currentX=e.clientX-M.offset().left,n=X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX),p.currentX>=0&&p.currentX<=h&&(g.css("left",n),t=p.currentX%w,r=(w/2>t?p.currentX-t:p.currentX+(w-t))/h*b,X?V!==r&&(V=r):H!==r&&(H=r),u(V,H),a(x.currentX)))}}),d.on("touchstart",function(e){e.preventDefault();var e=e.originalEvent;I={minHandle:{mouseX:e.targetTouches[0].pageX,currentX:parseInt(M.find(".minimum").css("left"),10)},maxHandle:{mouseX:e.targetTouches[0].pageX,currentX:parseInt(M.find(".maximum").css("left"),10)}},X="minimum"===$.fn.rangeSlider.chkHandle(this),p=X?I.minHandle:I.maxHandle,x=X?I.maxHandle:I.minHandle,g=X?M.find(".minimum"):M.find(".maximum")}),d.on("touchmove",function(e){if(e.preventDefault(),I){var n,t,r,e=e.originalEvent;e.targetTouches[0].pageX-M.offset().left<0||e.targetTouches[0].pageX-M.offset().left>h||(p.currentX=e.targetTouches[0].pageX-M.offset().left,n=X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX),p.currentX>=0&&p.currentX<=h&&(g.css("left",n),t=p.currentX%w,r=(w/2>t?p.currentX-t:p.currentX+(w-t))/h*b,X?V!==r&&(V=r):H!==r&&(H=r),u(V,H),a(x.currentX)))}}),d.on("touchend",function(e){if(I){var n=p.currentX%w;p.currentX=w/2>n?p.currentX-n:p.currentX+(w-n),(X&&p.currentX>x.currentX||!X&&p.currentX<x.currentX)&&(p.currentX=x.currentX),g.css("left",X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX)),X?V=p.currentX/h*b:H=p.currentX/h*b,u(V,H),i(),a(x.currentX),"function"==typeof v.onBlur&&v.onBlur(),I=null}}),$.fn.rangeSlider.initStatus=!0}function r(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function a(e){var n=[];d.each(function(){n.push(parseInt($(this).css("left"),10))}),l.css({left:X?c.css("left"):e,width:n[1]-n[0]})}function i(){c.css("z-index",X?3:2),o.css("z-index",X?2:3)}function u(e,n){X?M.attr("data-min",Math.min(Math.round(e),Math.round(n))):M.attr("data-max",Math.max(Math.round(e),Math.round(n))),X?m.text(r(Math.min(Math.round(e),Math.round(n)))+v.measure):f.text(r(Math.max(Math.round(e),Math.round(n)))+v.measure+(n===v.max&&v.maxOverflow?" 이상":""))}function s(){var e=v.showValueType;if(M.append('<span class="showValue minValue" style="position: absolute; left: 0;">'+r(V)+v.measure+"</span>"),M.append('<span class="showValue maxValue" style="position: absolute; right: 0;">'+r(H)+v.measure+(v.maxOverflow?" 이상":"")+"</span>"),m=M.find(".minValue"),f=M.find(".maxValue"),v.showValue)switch(e){case"follow":break;case"top":m.css({top:"-30px"}),f.css({top:"-30px"});break;case"bottom":m.css({top:"30px"}),f.css({top:"30px"});break;default:return}}var c,o,l,d,m,f,h,X,p,g,x,w,v=$.extend({},$.fn.rangeSlider.defaults,e||{}),M=$(this),b=v.max,S=v.min,H=b,V=S,I=null;n(),v.showValue&&s()})},$.fn.rangeSlider.initStatus=!1,$.fn.rangeSlider.defaults={width:"100%",height:"2px",colorStyle:"red",handleWidth:"28px",handleColor:"#ffffff",measure:"",maxOverflow:!0,max:100,min:0,step:1,showValue:!0,showValueType:"bottom"},$.fn.rangeSlider.chkHandle=function(e){return(" "+e.className+" ").indexOf(" minimum ")>-1?"minimum":"maximum"};
