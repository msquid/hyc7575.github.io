$.fn.rangeSlider=function(e){return this.each(function(){function n(){v.width(b.width).attr({"data-min":b.min,"data-max":b.max}),h=parseInt(v.width(),10)-parseInt(b.handleWidth),w=b.step*(h/M),v.append('<div class="range-slider-select-area"></div><span class="range-slider-handle minimum"></span><span class="range-slider-handle maximum"></span>'),c=v.find(".range-slider-handle.minimum"),o=v.find(".range-slider-handle.maximum"),l=v.find(".range-slider-select-area"),d=v.find(".range-slider-handle"),d.width(b.handleWidth),v.wrap('<div class="range-slider-wrap" style="padding: 30px 0 50px;"></div>'),v.css({position:"relative",width:b.width,height:b.height,filter:"progid:DXImageTransform.Microsoft.gradient(startColorStr=#66ff2402,endColorStr=#66ff2402)","-ms-filter":"progid:DXImageTransform.Microsoft.gradient(startColorStr=#66ff2402,endColorStr=#66ff2402)","background-color":"rgba(255, 115, 89, 0.4)"}),v.find(".range-slider-select-area").css({position:"absolute",width:"100%",height:"inherit",backgroundColor:"rgb(255, 115, 89)","z-ndex":1}),d.css({position:"absolute",top:-(parseInt(b.handleWidth,10)/2),width:b.handleWidth,height:b.handleWidth,borderRadius:"50%",backgroundColor:b.handleColor,border:"2px solid rgb(255, 115, 89)",cursor:"pointer",boxSizing:"border-box","z-index":2}),d.each(function(){var e=$(this);e.hasClass("minimum")?e.css("left",0):e.css({left:h})}),r()}function r(){d.on("mousedown",function(e){var e=window.event||e;$(this).css("background-color","#ff7359"),V={minHandle:{mouseX:e.clientX,currentX:parseInt(v.find(".minimum").css("left"),10)},maxHandle:{mouseX:e.clientX,currentX:parseInt(v.find(".maximum").css("left"),10)}},X="minimum"===$.fn.rangeSlider.chkHandle(this),p=X?V.minHandle:V.maxHandle,x=X?V.maxHandle:V.minHandle,g=X?v.find(".minimum"):v.find(".maximum")}),$(document).on("mouseup",function(){if(V){d.css("background-color","rgb(255,255,255)");var e=p.currentX%w;p.currentX=w/2>e?p.currentX-e:p.currentX+(w-e),(X&&p.currentX>x.currentX||!X&&p.currentX<x.currentX)&&(p.currentX=x.currentX),g.css("left",X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX)),X?k=p.currentX/h*M:H=p.currentX/h*M,u(k,H),i(),a(x.currentX),"function"==typeof b.onBlur&&b.onBlur(),V=null}}),$(document).on("mousemove",function(e){if($(".touch-area").text(),V){var n,r,t,e=window.event||e;e.clientX-v.offset().left<0||e.clientX-v.offset().left>h||(p.currentX=e.clientX-v.offset().left,n=X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX),p.currentX>=0&&p.currentX<=h&&(g.css("left",n),r=p.currentX%w,t=(w/2>r?p.currentX-r:p.currentX+(w-r))/h*M,X?k!==t&&(k=t):H!==t&&(H=t),u(k,H),a(x.currentX)))}}),d.on("touchstart",function(e){e.preventDefault();var e=e.originalEvent;$(this).css("background-color","#ff7359"),V={minHandle:{mouseX:e.targetTouches[0].pageX,currentX:parseInt(v.find(".minimum").css("left"),10)},maxHandle:{mouseX:e.targetTouches[0].pageX,currentX:parseInt(v.find(".maximum").css("left"),10)}},X="minimum"===$.fn.rangeSlider.chkHandle(this),p=X?V.minHandle:V.maxHandle,x=X?V.maxHandle:V.minHandle,g=X?v.find(".minimum"):v.find(".maximum")}),d.on("touchmove",function(e){if(e.preventDefault(),V){var n,r,t,e=e.originalEvent;e.targetTouches[0].pageX-v.offset().left<0||e.targetTouches[0].pageX-v.offset().left>h||(p.currentX=e.targetTouches[0].pageX-v.offset().left,n=X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX),p.currentX>=0&&p.currentX<=h&&(g.css("left",n),r=p.currentX%w,t=(w/2>r?p.currentX-r:p.currentX+(w-r))/h*M,X?k!==t&&(k=t):H!==t&&(H=t),u(k,H),a(x.currentX)))}}),d.on("touchend",function(e){if(V){d.css("background-color","rgb(255,255,255)");var n=p.currentX%w;p.currentX=w/2>n?p.currentX-n:p.currentX+(w-n),(X&&p.currentX>x.currentX||!X&&p.currentX<x.currentX)&&(p.currentX=x.currentX),g.css("left",X?Math.min(x.currentX,p.currentX):Math.max(x.currentX,p.currentX)),X?k=p.currentX/h*M:H=p.currentX/h*M,u(k,H),i(),a(x.currentX),"function"==typeof b.onBlur&&b.onBlur(),V=null}}),$.fn.rangeSlider.initStatus=!0}function t(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function a(e){var n=[];d.each(function(){n.push(parseInt($(this).css("left"),10))}),l.css({left:X?c.css("left"):e,width:n[1]-n[0]})}function i(){c.css("z-index",X?3:2),o.css("z-index",X?2:3)}function u(e,n){X?v.attr("data-min",Math.min(Math.round(e),Math.round(n))):v.attr("data-max",Math.max(Math.round(e),Math.round(n))),X?m.text(t(Math.min(Math.round(e),Math.round(n)))+b.measure):f.text(t(Math.max(Math.round(e),Math.round(n)))+b.measure+(n===b.max&&b.maxOverflow?" 이상":""))}function s(){var e=b.showValueType;if(v.append('<span class="showValue minValue" style="position: absolute; left: 0;">'+t(k)+b.measure+"</span>"),v.append('<span class="showValue maxValue" style="position: absolute; right: 0;">'+t(H)+b.measure+(b.maxOverflow?" 이상":"")+"</span>"),m=v.find(".minValue"),f=v.find(".maxValue"),b.showValue)switch(e){case"follow":break;case"top":m.css({top:"-30px"}),f.css({top:"-30px"});break;case"bottom":m.css({top:"30px"}),f.css({top:"30px"});break;default:return}}var c,o,l,d,m,f,h,X,p,g,x,w,b=$.extend({},$.fn.rangeSlider.defaults,e||{}),v=$(this),M=b.max,S=b.min,H=M,k=S,V=null;n(),b.showValue&&s()})},$.fn.rangeSlider.initStatus=!1,$.fn.rangeSlider.defaults={width:"100%",height:"2px",colorStyle:"red",handleWidth:"28px",handleColor:"#ffffff",measure:"",maxOverflow:!0,max:100,min:0,step:1,showValue:!0,showValueType:"bottom"},$.fn.rangeSlider.chkHandle=function(e){return(" "+e.className+" ").indexOf(" minimum ")>-1?"minimum":"maximum"};
